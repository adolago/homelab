# dnsmasq full configuration for homelab
# Serves DNS for .home.arpa + optional DHCP
#
# CUSTOMIZE: Replace example IPs with your network configuration
# Example uses 192.168.1.0/24 subnet - adjust to match your network

# ===========================================
# GENERAL SETTINGS
# ===========================================
# Don't use /etc/hosts
no-hosts

# Don't poll /etc/resolv.conf for changes
no-poll

# Never forward plain names (without a dot)
domain-needed

# Never forward addresses in non-routed address spaces
bogus-priv

# Upstream DNS servers (router + public fallbacks)
server=192.168.1.1        # Your router IP
server=1.1.1.1
server=8.8.8.8

# Cache size
cache-size=10000

# ===========================================
# LOCAL DOMAIN (.home.arpa)
# ===========================================
# RFC 8375 compliant local domain
local=/home.arpa/
domain=home.arpa

# Expand simple names to FQDN
expand-hosts

# ===========================================
# STATIC DNS ENTRIES
# ===========================================
# CUSTOMIZE: Update IPs to match your network

# Infrastructure
address=/hypervisor.home.arpa/192.168.1.2
address=/proxmox.home.arpa/192.168.1.2
address=/pve.home.arpa/192.168.1.2

address=/services.home.arpa/192.168.1.10
address=/storage.home.arpa/192.168.1.11
address=/nas.home.arpa/192.168.1.11
address=/truenas.home.arpa/192.168.1.11

address=/homeassistant.home.arpa/192.168.1.20
address=/ha.home.arpa/192.168.1.20

# Workstations (optional)
address=/desktop.home.arpa/192.168.1.100
address=/laptop.home.arpa/192.168.1.101

# Services on services VM (via Caddy reverse proxy)
address=/portainer.home.arpa/192.168.1.10
address=/grafana.home.arpa/192.168.1.10
address=/prometheus.home.arpa/192.168.1.10
address=/alertmanager.home.arpa/192.168.1.10
address=/loki.home.arpa/192.168.1.10
address=/cadvisor.home.arpa/192.168.1.10

address=/jellyfin.home.arpa/192.168.1.10
address=/media.home.arpa/192.168.1.10
address=/immich.home.arpa/192.168.1.10
address=/photos.home.arpa/192.168.1.10
address=/chat.home.arpa/192.168.1.10
address=/llm.home.arpa/192.168.1.10
address=/vllm.home.arpa/192.168.1.10

# DNS admin
address=/dns.home.arpa/192.168.1.10

# Wildcard for any undefined .home.arpa subdomains
address=/.home.arpa/192.168.1.10

# ===========================================
# DHCP CONFIGURATION (OPTIONAL)
# ===========================================
# Uncomment below to enable DHCP
# WARNING: Disable router DHCP first!

# DHCP range (leave room for static IPs: .1-.99)
# dhcp-range=192.168.1.100,192.168.1.200,24h

# Default gateway (router)
# dhcp-option=option:router,192.168.1.1

# DNS server (this dnsmasq)
# dhcp-option=option:dns-server,192.168.1.10

# Domain name
# dhcp-option=option:domain-name,home.arpa

# NTP server
# dhcp-option=option:ntp-server,192.168.1.1

# ===========================================
# DHCP STATIC LEASES
# ===========================================
# Uncomment and add your MAC addresses for static IPs
# Format: dhcp-host=<MAC>,<hostname>,<IP>,<lease-time>

# dhcp-host=aa:bb:cc:dd:ee:01,desktop,192.168.1.100,infinite
# dhcp-host=aa:bb:cc:dd:ee:02,laptop,192.168.1.101,infinite
# dhcp-host=aa:bb:cc:dd:ee:03,hypervisor,192.168.1.2,infinite
# dhcp-host=aa:bb:cc:dd:ee:04,services,192.168.1.10,infinite
# dhcp-host=aa:bb:cc:dd:ee:05,storage,192.168.1.11,infinite
# dhcp-host=aa:bb:cc:dd:ee:06,homeassistant,192.168.1.20,infinite

# ===========================================
# LOGGING
# ===========================================
log-queries
log-dhcp
log-facility=/var/log/dnsmasq.log

# ===========================================
# TFTP/PXE BOOT (FUTURE)
# ===========================================
# Uncomment to enable PXE boot
# enable-tftp
# tftp-root=/var/lib/tftpboot
# dhcp-boot=pxelinux.0
